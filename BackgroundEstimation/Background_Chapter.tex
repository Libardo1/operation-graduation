% Activate the following line by filling in the right side. If for example the name of the root file is Main.tex, write
% "...root = Main.tex" if the chapter file is in the same directory, and "...root = ../Main.tex" if the chapter is in a subdirectory.
 
%!TEX root =  ../Thesis.tex

\chapter[Background Estimation]{Background Estimation}

Once the background has been reduced as much as practical using the trigger and kinematic cuts,
a reliable estimate of the shape and size of the remaining background is critical to optimizing
the exclusion limits.  In particular, since the reconstructed mass peak of the $b$-jets is so
broad in signal, a mis-estimation of the background shape can lead to systematic errors that
could wash out any possible signal (or worse, be mistaken for a signal where there is none).  

At the same time, the backgrounds in this analysis are challenging to estimate, either in Monte
Carlo or using data-driven methods.  Therefore, much of the work of this analysis is dedicated
to validating the background estimation and providing uncertainties for especially the shape 
of the background.  

\section{Background Estimation Strategy}
\label{sec:background_strategy}
As QCD is the dominant background in this analysis, it is important to understand
what flavors of QCD jets compose the population of events that survive the cut
chain.  In order to do this, we apply the trigger and all cuts up to (but not including)
requiring a third $b$-tagged jet in the event.

 The signal and background are then split into 3 exclusive regions, defined as follows:
\begin{itemize}
    \item \textit{bbb}: one or more jets (in addition to the two triple-tagged jets) passing a tight (60\% working point)
 MV1 cut–-in effect, the full signal selection criteria
    \item \textit{bbloose}: events failing the bbb classification but which have one or more jets passing a loose (80\%
 working point) MV1 cut
    \item \textit{bbanti}: events that have no jets passing an 80\% MV1 cut-–effectively a veto on the presence of any
 $b$-tagged jets other than those firing the trigger
\end{itemize}

When assigning events to one of these categories, we only allow $b$-tags on the leading
five jets to count toward the $bbb$ or $bbloose$ categories.  In other words, if the third
$b$-tagged jet in an event is the 6th jet (in $p_T$ ordering) overall, the event 
will be classified as $bbanti$.  This requirement is motivated by our physics awareness that
the $b$-jets coming from signal events should be fairly high $p_T$, so this should have
a minimal effect of rejecting signal that would otherwise be accepted.  On the other
hand, with high-jet-multiplicity QCD events, there is the combinatorial effect of looking across
more jets for $b$-tags that increases the likelihood of an event being classified as signal-like
(bbb or bbloose) as there are more jets in the event.  Only looking at the leading 5 jets
for $b$-tags keeps this effect under control. 


\section{Background Estimation Method Based on Exponential Background Model and Sideband Fitting}
The background consists almost exclusively of QCD with 2 or more real $b$-jets, which 
fortunately has a $m_{bb}$ spectrum that does not have any peaks or other difficult
structure above about 350 GeV.  Below that mass, the trigger turn-on curve becomes
a major feature of the spectrum.  Above that mass, there
is a smoothly falling distribution that we fit primarily with a decaying exponential.

In a few words, the background fit strategy proceeds in the following way:
\begin{itemize}
    \item Start with a mass point
    \item Apply a mass-point-specific rotation based on the the eigenvectors of 
    the signal MC, as calculated using $m_{bb}$, $p_{T}^1$ and $p_T^2$; call 
    the components of this rotated basis $m_{bb}'$, $p_T^{1'}$ and $p_T^{2'}$
    \item Apply cuts to $p_T^{1'}$ and $p_T^{2'}$, and use $m_{bb}^{'}$ as the final 
    discriminating variable 
%    \item Using the signal MC as a guide, select a window in $m_{bb}$ that encloses the
%signal peak, along with as much of the mass sideband (on either side) as possible
    \item Fit an exponential function to the $m_{bb}^{'}$ distribution, allowing each of the 
tag regions (\textit{bbb}, \textit{bbloose}, \textit{bbanti}) to float relative to each other
 as well as keeping the 3, 4, and 5+ jet categories separate
    \item As part of the limit-setting procedure, use the fit result for the 
    background along with signal shapes taken from MC to extract the 
signal cross section that can be excluded at a 95\% confidence level
    \item Repeat for the next mass point
\end{itemize}

Although we have signal MC with $m_A$ values as low as 250 GeV, this fit strategy only
begins to work above 400 GeV, because of the trigger turn-on curve.  The fit window
used is [340,900] GeV for all signal mass points.

While the analysis was in development, it was blinded to avoid bias.  This was done 
by removing \textit{bbb} events from the data, and replacing them with a sample of
events with the same normalization drawn from the \textit{bbanti} distribution
in data.  For the final search, the \textit{bbb} events were swapped back in.



%\section{Turn-On Curve Modeling}
%Although the lowest part of the $m_{bb}$ distribution (below 300 GeV) is not part of the search regime,
%because of the rapidly changing background, including it in the background model helps
%improve the overall fit by allowing for a slightly fewer events at moderately low
%$m_{bb}$ (between about 300 and 400 GeV) than an exponential alone would predict.
%The turn-on is fit with a logistic function of the form

%\begin{equation}
%f(m_{bb}) = N\frac{1}{1+e^{-c(m_{bb}+d)}}
%\end{equation}

%In this equation, N controls the overall normalization, $c$ governs the steepness
%of the turn-on curve, and $d$ is the horizontal offset.

%\textbf{once we confirm this (or something like it) as the final fit model,
%add a plot showing how this function changes with c/d and the composite
%model of exponential times logistic}


\section{Mathematical Modeling of Background Shape}
\subsection{Selection of Exponential Function}
Once the rotation and cuts have been applied, the data is fed into an 
unbinned maximum likelihood fit for mathematical modeling.  The fitting
of both signal and background is done in RooFit.  There are a number 
of candidate functions for the background fit, which can be evaluated
both on their goodness-of-fit (as measured by a metric like $\chi^2/DOF$)
and their ease of convergence.

In brief, the functions given consideration include the following:
\begin{itemize}
    \item Bernstein Polynomial
    \item Power Decay Series
    \item Decaying Exponential with 1 parameter
    \item Decaying Exponential with 2 parameters
\end{itemize}

\subsubsection{Bernstein Polynomials}
The Bernstein polynomials are a family of polynomials that are characterized
particularly by their attractive feature of being positive-definite, or never
predicting a negative value for a PDF composed of them.  However, we find
that it takes a high degree of polynomial (5 parameters or more) to fit the
background over the full mass range (340,900 GeV), and a polynomial with a 
degree this high struggles (and often fails) to converge.  Moreover, a
drawback of high-degree polynomials is their capability to ``wiggle'' and
potentially absorb a signal within the background model.

\subsubsection{Power Decay Series}
A power decay series of the form $\frac{a}{x} + \frac{b}{x^3} + \frac{c}{x^5} + ...$
is another possibility; if all the powers of $x$ in the denominators are
odd, this series cannot wiggle like the Bernstein polynomials.  However,
a simple series with a few terms does not fit the background shape well 
over the full mass range, and when many terms are added to the series then
the fit struggles to find a global maximum of the likelihood function, leading
to non-convergence.

\subsubsection{Decaying Exponential with 1 Parameter}
Like a decaying power series, a decaying exponential function is monotonically
decreasing; however, unlike a power series, an exponential with a single
parameter (i.e. a model of the form $f(x)=e^{-x/\tau}$) provides 
a relatively good fit to the background distribution in most tag and jet
categories, with $\chi^2/DOF$ values below 2 for all \textit{bbb} and \textit{bbloose}
distributions \footnote{the \textit{bbanti} distributions prove harder to
fit with a 1-parameter exponential, with $\chi^2/DOF$ values between 2.8 and 3.9}.
Additionally, the simplicity of a 1-parameter exponential means that the
fits converge quickly and reliably over the full mass range.

\subsubsection{Decaying Exponential with 2 Parameters}
A decaying exponential with two parameters (i.e. a model of the form  $f(x)=e^{-x/\tau+\omega x^2}$)
has the same nice features of a single-parameter exponential (simple functional
form, easy convergence, no possibility of signal-spoofing wiggles) while offering
more flexibility than the 1-parameter exponential.  The $\chi^2/DOF$ and pulls
for the 2-parameter exponential fits reflect this flexibility to better
fit the data, every jet/tag category has a fit that is as good or better
for the 2-parameter exponential as for the 1-parameter exponential.  In 
particular, the \textit{bbanti} categories that have higher $\chi^2/DOF$ values
in the 1-parameter fit show $\chi^2/DOF$ results of 1.0-1.2 with the 2-parameter fits. 

\subsection{Goodness-of-Fit Comparisons}
After comparing all the options for the function to describe the background
shape, the exponentials (both 1-parameter and 2-parameters) had the best
combination of fitting the background well and converging stably over the
full mass range.  The goodness-of-fit of these two possibilities, as measured
by the function $\chi^2/DOF$, is in Table~\ref{tab:chi2}.

\begin{table}
    \center
    \caption{The $\chi^2/DOF$ for the 1-parameter and 2-parameter exponential fits.
    \label{tab:chi2}}
    \begin{tabular}{ c p{3cm} p{3cm} } \hline \hline
        category & 1-parameter exponential $\chi^2/DOF$ & 2-parameter exponential $\chi^2/DOF$ \\ \hline
        \textit{bbb} 3 jet & 1.5 & 1.1 \\
        \textit{bbb} 4 jet & 0.9  & 0.7 \\
        \textit{bbb} 5+ jet & 0.9  & 0.7 \\
        \textit{bbloose} 3 jet & 0.8 & 0.6 \\
        \textit{bbloose} 4 jet & 1.2 & 0.7 \\
        \textit{bbloose} 5+ jet & 1.5 & 1.1 \\
        \textit{bbanti} 3 jet & 3.9 & 1.0 \\
        \textit{bbanti} 4 jet & 3.9 & 1.2 \\
        \textit{bbanti} 5+ jet & 2.8 & 1.2 \\
        \hline
    \end{tabular}
\end{table} 

As Table~\ref{tab:eigenvector_elements} shows, the largest component of




\subsection{Background Shape and Spurious Signal}
Another consideration when choosing a model for the background is the possiblity
that it could introduce bias in the form of spurious signal ($N_{sp}$), or signal that is 
not really ``there'' but is found by the signal+background fit anyway when fitting over the 
full mass range.  Following the prescription in the Standard Model $h\rightarrow\gamma\gamma$
search \cite{spurious_signal}, the model must meet at least one of the following
criteria:

\begin{itemize}
    \item $N_{sp}<$ 10\% $N_{s,exp}$
    \item $N_{sp}<$ 20\% $\sigma_{bkg}$
\end{itemize}

$N_{s,exp}$ is the number of signal events expected to pass the event selection cuts, and 
$\sigma_{bkg}$ is the statistical uncertainty on the number of background events when
fitting the signal+background model to the background-only Asimov dataset.

\textbf{fill in results of these tests after they have been completed}


\subsection{Non-QCD Background}
\label{sec:non_qcd_bkgs}

\subsubsection{All-Hadronic $t\bar{t}$ Background}
When $t\bar{t}$ decays all-hadronically, it can create events with several high-$p_T$
jets and 2 or more $b$-tagged jets (where the $b$-tags come from both real $b$-quarks
and from mistagged light flavor).  We anticipate that, because it has a production
cross section that is much smaller than QCD, $t\bar{t}$ will not be a major background.
We confirm this assumption in MC by using the all-hadronic $t\bar{t}$ sample summarized
in Table~\ref{tab:ttbar_params}.


We find that in MC, all-hadronic $t\bar{t}$ has an efficiency of 7.5\% after
the EF\_2j35\_loose\_j145\_j35\_a4tchad trigger, and approximately 2\% efficiency
in the offline cuts relative to the trigger.  Estimating the $t\bar{t}$ cross section
as 165 pb, and a 44\% branching ratio in the all-hadronic decay channel, this gives
a 0.11 pb $t\bar{t}$ cross section expected after the trigger and offline cuts.  In the
full 2012 dataset, this amounts to about 2400 events.  While
this is not a negligible cross section compared to the signal, it is more than an
order of magnitude smaller than the QCD background.

In addition to checking the magnitude of the $t\bar{t}$ background, we check the shape
for any shape differences in the $m_{bb}$ distribution depending on the tag status of the
third jet, and do not find any major discrepancies that point toward $t\bar{t}$ as a
potential peaking background in the signal region. The $m_{bb}$ distributions in the
bbb, bbloose and bbanti bins for the all-hadronic $t\bar{t}$ can be found in Figure
~\ref{fig:ttbar_mbb}.




\begin{figure}[hbt]
\includegraphics[width=0.45\linewidth]{BackgroundEstimation/images/mbb_compare_bbb_bbloose_bbanti_ttbar.eps}
\includegraphics[width=0.45\linewidth]{BackgroundEstimation/images/mbb_compare_bbb_bbloose_bbanti_ttbar_logy.eps}
\caption{The $m_{bb}$ distributions for all-hadronic $t\bar{t}$ MC after the trigger and all offline cuts are applied (linear Y axis on the left, logarithmic scale on the right).  In addition to the overall cross-section, we also want to probe any shape differences that arise when the tag status changes on the third jet in the event.  No significant shape differences are seen.}
\label{fig:ttbar_mbb}
\end{figure}

















